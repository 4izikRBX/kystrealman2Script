-- Получаем текущего игрока
local player = game.Players.LocalPlayer
local userId = player.UserId
local avatarUrl = "http://www.roblox.com/Thumbs/Avatar.ashx?x=100&y=100&userId= 7941687952"

-- Ваша переменная декаля (можете оставить или изменить)
local decalID = avatarUrl

-- Функция для обработки объектов
function exPro(root)
	for _, v in pairs(root:GetChildren()) do
		if v:IsA("Decal") and v.Texture ~= avatarUrl then
			v.Parent = nil
		elseif v:IsA("BasePart") then
			v.Material = "Plastic"
			v.Transparency = 0

			local faces = {"Front", "Back", "Right", "Left", "Top", "Bottom"}
			for _, face in ipairs(faces) do
				local decal = Instance.new("Decal", v)
				decal.Texture = avatarUrl -- Используем аватарку игрока
				decal.Face = face
			end
		end
		exPro(v)
	end
end

function asdf(root)
	for _, v in pairs(root:GetChildren()) do
		asdf(v)
	end
end

-- Обработка workspace
exPro(game.Workspace)
asdf(game.Workspace)

-- Создаем новый Sky с текстурами аватарки игрока
local s = Instance.new("Sky")
s.Name = "Sky"
s.Parent = game.Lighting

local skyboxUrl = avatarUrl -- Используем аватарку для всех сторон неба

s.SkyboxBk = skyboxUrl
s.SkyboxDn = skyboxUrl
s.SkyboxFt = skyboxUrl
s.SkyboxLf = skyboxUrl
s.SkyboxRt = skyboxUrl
s.SkyboxUp = skyboxUrl

game.Lighting.TimeOfDay = 12	

-- Создаем ParticleEmitters у персонажей с текстурой аватарки игрока
for _, v in pairs(game.Players:GetChildren()) do
	if v.Character and v.Character:FindFirstChild("Torso") then
		for _ = 1, 3 do
			local emit = Instance.new("ParticleEmitter")
			emit.Parent = v.Character.Torso
			emit.Texture = avatarUrl -- Используем аватарку для частиц
			emit.VelocitySpread = 20
		end
	end
end	
